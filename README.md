#  QNLI Probe: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∑–Ω–∞–Ω–∏–π –∏–∑ Hidden States LLM

–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ probe-–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è—Ö —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ Qwen2.5-0.5B –¥–ª—è –∑–∞–¥–∞—á–∏ QNLI.

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–ü–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ **–æ–±—É—á–µ–Ω–∏–µ –Ω–∞ hidden states** LLM –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–≤–æ—Å—Ö–æ–¥–∏—Ç zero-shot –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á –ø–æ–Ω–∏–º–∞–Ω–∏—è —è–∑—ã–∫–∞.

## üìä –ö–ª—é—á–µ–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

| –ú–µ—Ç–æ–¥ | Val Accuracy | –û–ø–∏—Å–∞–Ω–∏–µ |
|-------|--------------|----------|
| LLM Zero-Shot | 57.92% | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è yes/no –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è |
| MLPProbe (layer 14) | 83.93% | MLP –Ω–∞ –æ–¥–Ω–æ–º —Å–ª–æ–µ |
| **HybridProbe** | **91.36%** | Multi-layer fusion + —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è |

**–£–ª—É—á—à–µ–Ω–∏–µ**: +33.44% –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å zero-shot üöÄ

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è

                                Qwen2.5-0.5B (frozen)
                                          |
                        +-----------------+-----------------+
                        |                 |                 |
                    Extra Layers      Main Layer        Extra Layers
                 [9, 10, 11, 12]         [13]          [14, 15, 16]
                        |                 |                 |
                     Pooled            Sequence           Pooled
                        |                 |                 |
                        |             Transformer           | 
                        |              Encoder              |
                        |                 |                 |
                        +---------> Weighted Fusion <-------+
                                        |
                                    Classifier
                                        |
                                      91.36%

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
‚îú‚îÄ‚îÄ config.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è  
‚îú‚îÄ‚îÄ src/  
‚îÇ   ‚îú‚îÄ‚îÄ model.py                 # HybridProbe –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞  
‚îÇ   ‚îú‚îÄ‚îÄ data.py                  # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏ hidden states  
‚îÇ   ‚îú‚îÄ‚îÄ trainer.py               # Training loop  
‚îÇ   ‚îú‚îÄ‚îÄ losses.py                # Label Smoothing, R-Drop  
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                 # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏  
‚îú‚îÄ‚îÄ scripts/  
‚îÇ ‚îú‚îÄ‚îÄ train.py # –°–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è  
‚îÇ ‚îî‚îÄ‚îÄ evaluate.py # –°–∫—Ä–∏–ø—Ç –æ—Ü–µ–Ω–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏  
‚îú‚îÄ‚îÄ results/  
‚îÇ   ‚îú‚îÄ‚îÄ best_model/              # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –æ–ø–∏—Å–∞–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ —Å –ª—É—á—à–µ–π –º–æ–¥–µ–ª—å—é  
‚îÇ   ‚îú‚îÄ‚îÄ best-layer-search/       # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑—ã —Å–ª–æ–µ–≤ LLM  
‚îÇ   ‚îî‚îÄ‚îÄ llm_baseline/            # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —á–∏—Å—Ç–æ–π LLM  
‚îî‚îÄ‚îÄ outputs/  
    ‚îî‚îÄ‚îÄ best_light_model.pt            # –õ—É—á—à–∞—è –º–æ–¥–µ–ª—å 


## –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
### 1. –ê–Ω–∞–ª–∏–∑ —Å–ª–æ—ë–≤ (MLPProbe)
–ü–æ–∏—Å–∫ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Å–ª–æ—ë–≤ –¥–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏.

- **–õ—É—á—à–∏–µ —Å–ª–æ–∏**: 13-14 (~85% accuracy)
- **–í—ã–≤–æ–¥**: –°—Ä–µ–¥–Ω–∏–µ —Å–ª–æ–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç –±–æ–ª—å—à–µ —Å–µ–º–∞–Ω—Ç–∏–∫–∏

### 2. HybridProbe (Multi-layer Fusion)

–û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏–∑ 8 —Å–ª–æ—ë–≤ —Å —Å–∏–ª—å–Ω–æ–π —Ä–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏–µ–π.

| –ú–µ—Ç—Ä–∏–∫–∞ | Train | Validation |
|---------|-------|------------|
| Accuracy | 91.61% | 91.36% |
| F1-Score | 0.9161 | 0.9136 |

**Overfitting gap**: 0.25% ‚úÖ

### 3. LLM Zero-Shot Baseline

–û—Ü–µ–Ω–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ç–∏–≤–Ω—ã—Ö —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–µ–π –º–æ–¥–µ–ª–∏ –±–µ–∑ –æ–±—É—á–µ–Ω–∏—è.

- **Accuracy**: 57.92%
- **–í—ã–≤–æ–¥**: –ú–∞–ª–µ–Ω—å–∫–∏–µ LLM –Ω–µ —Å–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å QNLI –≤ zero-shot

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞

```bash
git clone https://github.com/ravil75/DL_PROJECT.git
cd DL_PROJECT
pip install -r requirements.txt 
```

### –û–±—É—á–µ–Ω–∏–µ 
```python
python scripts/train.py
```

## –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏

| Training Curves | Confusion Matrix |
|:---------------:|:----------------:|
| ![Training](results/best_model/figures/training_curves.png) | ![Confusion](results/best_model/figures/confusion_matrix.png) |

| Confidence Analysis |
|:-------------------:|
| ![Confidence](results/best_model/figures/confidence_analysis.png) |

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã
1. Hidden states > Generation: Probe –Ω–∞ —Å–∫—Ä—ã—Ç—ã—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö –¥–∞—ë—Ç +33% accuracy

2. –†–µ–≥—É–ª—è—Ä–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–Ω–∞: –ë–µ–∑ –Ω–µ—ë overfitting

3. –°—Ä–µ–¥–Ω–∏–µ —Å–ª–æ–∏ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã: –°–ª–æ–∏ 13-14 —Å–æ–¥–µ—Ä–∂–∞—Ç –º–∞–∫—Å–∏–º—É–º —Å–µ–º–∞–Ω—Ç–∏–∫–∏


##  –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
| –ü–∞—Ä–∞–º–µ—Ç—Ä      | –ó–Ω–∞—á–µ–Ω–∏–µ                      |
| ------------- | ----------------------------- |
| Base LLM      | Qwen2.5-0.5B (896 hidden dim) |
| Main layer    | 13                            |
| Extra layers  | [9, 10, 11, 12, 14, 15, 16]   |
| Dropout       | 0.4                           |
| Learning rate | 5e-5                          |
| Batch size    | 64                            |

## –î–∞—Ç–∞—Å–µ—Ç

 - GLUE QNLI (Question-answering NLI)

 - Train: 104 743 –ø—Ä–∏–º–µ—Ä–æ–≤

 - Validation: 5 463 –ø—Ä–∏–º–µ—Ä–æ–≤

 - –ó–∞–¥–∞—á–∞: –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç –Ω–∞ –≤–æ–ø—Ä–æ—Å
